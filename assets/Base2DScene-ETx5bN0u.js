var G=Object.defineProperty;var b=(u,t,e)=>t in u?G(u,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):u[t]=e;var y=(u,t,e)=>b(u,typeof t!="symbol"?t+"":t,e);import{W as k,P as R,S as B,c as F,C as p,d as A,e as m,B as x,L as E,f,g as L,M as z,h as N,Q as P,V as S}from"./index-D1NIF6BJ.js";class I{constructor(t){y(this,"geometryManager",A.getInstance());y(this,"renderer");y(this,"scene");y(this,"camera");y(this,"sliders");y(this,"render",()=>{this.renderer.render(this.scene,this.camera),requestAnimationFrame(this.render)});this.canvas=t,this.renderer=new k({antialias:!0,preserveDrawingBuffer:!0,canvas:t}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(t.clientWidth,t.clientHeight,!1);const e=75,a=t.clientWidth/t.clientHeight,r=.1,n=1e3;this.camera=new R(e,a,r,n),this.camera.position.set(0,0,200),this.camera.lookAt(0,0,0),this.scene=new B,this.scene.background=new F(p.BACKGROUND),this.sliders=document.getElementById("sliders"),window.addEventListener("keydown",s=>{(s.key==="s"||s.key==="S")&&this.saveScreenshot()}),window.addEventListener("resize",this.onWindowResize.bind(this))}saveScreenshot(){const e=this.renderer.domElement.toDataURL("image/png"),a=document.createElement("a");a.href=e,a.download="non-gon-scene.png",a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)}makeAxes(){const e=this.makeClippedAxis(new m(1,0,0),100,p.RED),a=this.makeClippedAxis(new m(-1,0,0),100,p.RED),r=this.makeClippedAxis(new m(0,1,0),100,p.BLUE),n=this.makeClippedAxis(new m(0,-1,0),100,p.BLUE);this.scene.add(e,a,r,n);const s=this.makeArrowCone(new m(1,0,0),100,p.RED),i=this.makeArrowCone(new m(0,1,0),100,p.BLUE);this.scene.add(s,i)}makeClippedAxis(t,e,a){const r=[new m(0,0,0),t.clone().multiplyScalar(e)],n=new x().setFromPoints(r),s=new E({color:a,linewidth:2});return new f(n,s)}makeArrowCone(t,e,a){const s=new L(2,4,16),i=new z({color:a}),l=new N(s,i);s.translate(0,-4/2,0);const h=new m(0,1,0),o=new P().setFromUnitVectors(h,t.clone().normalize());l.applyQuaternion(o);const c=t.clone().setLength(e);return l.position.copy(c),l}makeSlidersSolo(t,e,a,r){const n=document.createElement("fieldset"),s=document.createElement("legend");s.textContent=t,n.appendChild(s),r!==void 0?this.makeLineSegmentEndpointsSliders(n,r,e):this.makeShapeCenterSliders(n,t,e),this.makeShapeRotationSliders(n,t,e),this.sliders&&this.sliders.appendChild(n)}makeSlidersInteraction(t,e,a,r){this.makeSlidersInteractionAux(t,e,a),this.makeSlidersInteractionAux(e,t,a,r)}makeSlidersInteractionAux(t,e,a,r){const n=document.createElement("fieldset"),s=document.createElement("legend");s.textContent=t.getId(),n.appendChild(s),r!==void 0?this.makeLineSegmentEndpointsSliders(n,r,r.getColor()):this.makeShapeCenterSlidersInteraction(n,t,e,a),a!==void 0&&this.makeShapeRotationSlidersInteraction(n,t,e,a),this.sliders&&this.sliders.appendChild(n)}makeShapeCenterSliders(t,e,a){const r=this.geometryManager.getGeometry(e).center;[["Center X: ",r.x,s=>this.geometryManager.changeCenterX(e,s)],["Center Y: ",r.y,s=>this.geometryManager.changeCenterY(e,s)]].forEach(([s,i,l])=>{const h=document.createElement("label");h.textContent=s;const o=document.createElement("input");o.type="range",o.min="-100",o.max="100",o.step="0.01",o.value=i.toString(),o.addEventListener("input",()=>{const c=parseFloat(o.value);this.scene.remove(this.scene.getObjectByName(e)),l(c),this.scene.add(this.geometryManager.getGeometryMesh(e,a,"mesh"))}),h.appendChild(o),t.appendChild(h),t.appendChild(document.createElement("br"))})}makeLineSegmentEndpointsSliders(t,e,a){const r=e.start,n=e.end;[["Start X: ",r.x,i=>e.start=new S(i,r.y)],["Start Y: ",r.y,i=>e.start=new S(r.x,i)],["End X: ",n.x,i=>e.end=new S(i,n.y)],["End Y: ",n.y,i=>e.end=new S(n.x,i)]].forEach(([i,l,h])=>{const o=document.createElement("label");o.textContent=i;const c=document.createElement("input");c.type="range",c.min="-100",c.max="100",c.step="0.01",c.value=l.toString(),c.addEventListener("input",()=>{const C=parseFloat(c.value);this.scene.remove(this.scene.getObjectByName(e.getId())),h(C),this.scene.add(this.geometryManager.getGeometryMesh(e.getId(),a,"line"))}),o.appendChild(c),t.appendChild(o),t.appendChild(document.createElement("br"))})}makeShapeRotationSliders(t,e,a){[["Rotation: ",this.geometryManager.getGeometry(e).rotation.z,s=>this.geometryManager.changeRotationZ(e,s)]].forEach(([s,i,l])=>{const h=document.createElement("label");h.textContent=s;const o=document.createElement("input");o.type="range",o.min="-360",o.max="360",o.step="0.01",o.value=i.toString(),o.addEventListener("input",()=>{const c=parseFloat(o.value);this.scene.remove(this.scene.getObjectByName(e)),l(c),this.scene.add(this.geometryManager.getGeometryMesh(e,a,"mesh"))}),h.appendChild(o),t.appendChild(h),t.appendChild(document.createElement("br"))})}makeShapeCenterSlidersInteraction(t,e,a,r){const n=e.getId(),s=e.getColor(),i=a.getId(),l=a.getColor(),h=this.geometryManager.getGeometry(n).center;[["Center X: ",h.x,c=>this.geometryManager.changeCenterX(n,c)],["Center Y: ",h.y,c=>this.geometryManager.changeCenterY(n,c)]].forEach(([c,C,v])=>{const g=document.createElement("label");g.textContent=c;const d=document.createElement("input");d.type="range",d.min="-100",d.max="100",d.step="0.01",d.value=C.toString(),d.addEventListener("input",()=>{const w=parseFloat(d.value);if(this.scene.remove(this.scene.getObjectByName(n)),v(w),r!==void 0){this.scene.add(this.geometryManager.getGeometryMesh(n,s,"mesh"));const M=this.geometryManager.calculateShortestDistance(n,i);this.scene.remove(this.scene.getObjectByName(this.drawShortestDistance(M[0],M[1],r)))}else this.geometryManager.calculateProximityQuery(n,i)?(this.scene.remove(this.scene.getObjectByName(i)),this.geometryManager.deletePreviousGeometry(i),this.scene.add(this.geometryManager.getGeometryMesh(n,s,"line")),this.scene.add(this.geometryManager.getGeometryMesh(i,l,"line"))):(this.scene.remove(this.scene.getObjectByName(i)),this.geometryManager.deletePreviousGeometry(i),this.scene.add(this.geometryManager.getGeometryMesh(n,s,"mesh")),this.scene.add(this.geometryManager.getGeometryMesh(i,l,"mesh")))}),g.appendChild(d),t.appendChild(g),t.appendChild(document.createElement("br"))})}makeShapeRotationSlidersInteraction(t,e,a,r){const n=e.getId(),s=e.getColor(),i=a.getId(),l=a.getColor();[["Rotation Z: ",this.geometryManager.getGeometry(n).rotation.z,c=>this.geometryManager.changeRotationZ(n,c)]].forEach(([c,C,v])=>{const g=document.createElement("label");g.textContent=c;const d=document.createElement("input");d.type="range",d.min="-360",d.max="360",d.step="0.01",d.value=C.toString(),d.addEventListener("input",()=>{const w=parseFloat(d.value);if(this.scene.remove(this.scene.getObjectByName(n)),v(w),r!==void 0){this.scene.add(this.geometryManager.getGeometryMesh(n,s,"mesh"));const M=this.geometryManager.calculateShortestDistance(n,i);this.scene.remove(this.scene.getObjectByName(this.drawShortestDistance(M[0],M[1],r)))}else this.geometryManager.calculateProximityQuery(n,i)?(this.scene.remove(this.scene.getObjectByName(i)),this.geometryManager.deletePreviousGeometry(i),this.scene.add(this.geometryManager.getGeometryMesh(n,s,"line")),this.scene.add(this.geometryManager.getGeometryMesh(i,l,"line"))):(this.scene.remove(this.scene.getObjectByName(i)),this.geometryManager.deletePreviousGeometry(i),this.scene.add(this.geometryManager.getGeometryMesh(n,s,"mesh")),this.scene.add(this.geometryManager.getGeometryMesh(i,l,"mesh")))}),g.appendChild(d),t.appendChild(g),t.appendChild(document.createElement("br"))})}onWindowResize(){const t=this.canvas.clientWidth,e=this.canvas.clientHeight;(this.canvas.width!==t||this.canvas.height!==e)&&(this.renderer.setSize(t,e,!1),this.camera.aspect=t/e,this.camera.updateProjectionMatrix())}startAnimation(){this.buildScene(),this.render()}drawShortestDistance(t,e,a){console.log(t,e);const r=new E({color:a}),n=new x().setFromPoints([new m(parseFloat(t.x.toFixed(3)),parseFloat(t.y.toFixed(3)),"z"in t?parseFloat(t.z.toFixed(3)):0),new m(parseFloat(e.x.toFixed(3)),parseFloat(e.y.toFixed(3)),"z"in e?parseFloat(e.z.toFixed(3)):0)]),s=new f(n,r);return s.name="connection",this.scene.add(s),s.name}}export{I as B};
